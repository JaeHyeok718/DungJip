<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="estateReviewMapper">

	<resultMap type="estateReview" id="estateReviewResultSet">
		<result column="ES_RE_NO" property="esReNo"/>
		<result column="USER_NO" property="userNo"/>
		<result column="ES_NO" property="esNo"/>
		<result column="ES_RE_SCORE" property="esReScore"/>
		<result column="ES_RE_CONTENT" property="esReContent"/>
		<result column="ES_RE_CREATE_DATE" property="esReCreateDate"/>
		<result column="ES_RE_TYPE" property="esReType"/>
		<result column="ES_RE_STATUS" property="esReStatus"/>
		<result column="HOUSE_NO" property="houseNo"/>
				
	</resultMap>
	
	<select id="selectEstateReview" resultMap="estateReviewResultSet" >

		SELECT ES_RE_NO
		        ,ER.ES_NO
		        ,ER.USER_NO
		        ,ES_RE_SCORE
		        ,ES_RE_CONTENT
		        ,ES_RE_CREATE_DATE
		        ,ES_RE_TYPE
		        ,ES_RE_STATUS
		        ,ER.HOUSE_NO
		FROM ESTATE_REVIEW ER
		JOIN ESTATE E ON ER.ES_NO  = E.ES_NO
		JOIN HOUSE H ON ER.HOUSE_NO = H.HOUSE_NO
		WHERE ER.USER_NO = #{userNo}
		AND ES_RE_STATUS='Y'
	
	</select>
	
	<delete id="esReviewDelete" parameterType="_int">		
		UPDATE ESTATE_REVIEW
		SET ES_RE_STATUS = 'N'
		WHERE ES_RE_STATUS = 'Y'
		AND ES_RE_NO = #{esReNo}
	</delete>
	
	<update id="updateReview">
		UPDATE ESTATE_REVIEW
		SET ES_RE_SCORE = #{esReScore}
		    ,ES_RE_CONTENT = #{esReContent}
		    ,ES_RE_CREATE_DATE = SYSDATE
		WHERE ES_RE_NO = #{esReNo}
		AND ES_RE_STATUS='Y'  
	</update>

</mapper>
